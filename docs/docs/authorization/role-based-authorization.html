<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Role-based authorization - Microsoft Orleans Security</title><link rel="shortcut icon" href="https://orlsec.asynchub.org/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="https://orlsec.asynchub.org/assets/css/just-the-docs.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "UA-2709176-10"); </script> <script type="text/javascript" src="https://orlsec.asynchub.org/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://orlsec.asynchub.org/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Role-based authorization | Microsoft Orleans Security</title><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="Role-based authorization" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Jekyll theme for documentation" /><meta property="og:description" content="A Jekyll theme for documentation" /><link rel="canonical" href="https://orlsec.asynchub.org/docs/authorization/role-based-authorization" /><meta property="og:url" content="https://orlsec.asynchub.org/docs/authorization/role-based-authorization" /><meta property="og:site_name" content="Microsoft Orleans Security" /> <script type="application/ld+json"> {"url":"https://orlsec.asynchub.org/docs/authorization/role-based-authorization","headline":"Role-based authorization","description":"A Jekyll theme for documentation","@type":"WebPage","@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="https://orlsec.asynchub.org" class="site-title lh-tight"> Microsoft Orleans Security </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item"><a href="https://orlsec.asynchub.org/" class="navigation-list-link">Home</a><li class="navigation-list-item active"><a href="https://orlsec.asynchub.org/docs/authorization" class="navigation-list-link">Authorization</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://orlsec.asynchub.org/docs/authorization/overview" class="navigation-list-link">Overview</a><li class="navigation-list-item "><a href="https://orlsec.asynchub.org/docs/authorization/simple-authorization" class="navigation-list-link">Simple authorization</a><li class="navigation-list-item active"><a href="https://orlsec.asynchub.org/docs/authorization/role-based-authorization" class="navigation-list-link active">Role-based authorization</a><li class="navigation-list-item "><a href="https://orlsec.asynchub.org/docs/authorization/policy-based-authorization" class="navigation-list-link">Policy-based authorization</a></ul></ul></nav></div><footer class="site-footer"></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Microsoft Orleans Security" aria-label="Search Microsoft Orleans Security" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg></div><div class="js-search-results search-results-wrap"></div></div><ul class="list-style-none text-small aux-nav"><li class="d-inline-block my-0"><a href="//github.com/Async-Hub/Orleans.Security">Microsoft Orleans Security on GitHub</a></ul></div><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://orlsec.asynchub.org/docs/authorization">Authorization</a><li class="breadcrumb-nav-list-item"><span>Role-based authorization</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 id="role-based-authorization"> <a href="#role-based-authorization" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Role-based authorization</h1><p>When an identity is created it may belong to one or more roles. For example, Alice may belong to the Administrator and User roles whilst Bob may only belong to the User role. How these roles are created and managed depends on the IdentityServer4 of the authorization process.</p><p>Role-based authorization checks are declarativeâ€”the developer embeds them within their code, against a grain interface or an method within a grain interface, specifying roles which the current <em>user</em> or <em>client</em> (please <a href="http://docs.identityserver.io/en/latest/intro/terminology.html">see</a> IdentityServer4 terminology) must be a member of to access the requested resource.</p><p>For example, the following code limits access to any methods on the implementation of <strong><code class="highlighter-rouge">IUserGrain</code></strong> to users/clients who are a member of the Administrator role:</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span> <span class="p">=</span> <span class="s">"Administrator"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IUserGrain</span> <span class="p">:</span> <span class="n">IGrainWithStringKey</span>
<span class="p">{</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomething</span><span class="p">();</span>

    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomethingElse</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div><p>You can specify multiple roles as a comma separated list:</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span> <span class="p">=</span> <span class="s">"Administrator, Manager"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IUserGrain</span> <span class="p">:</span> <span class="n">IGrainWithStringKey</span>
<span class="p">{</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomething</span><span class="p">();</span>

    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomethingElse</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div><p>This grain would be only accessible by users/clients who are members of the <code class="highlighter-rouge">Administrator</code> role or the <code class="highlighter-rouge">Manager</code> role.</p><p>If you apply multiple attributes then an accessing user/client must be a member of all the roles specified; the following sample requires that a user must be a member of both the <code class="highlighter-rouge">Developer</code> and <code class="highlighter-rouge">Manager</code> role.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span> <span class="p">=</span> <span class="s">"Developer"</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span> <span class="p">=</span> <span class="s">"Manager"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IUserGrain</span> <span class="p">:</span> <span class="n">IGrainWithStringKey</span>
<span class="p">{</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomething</span><span class="p">();</span>

    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomethingElse</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div><p>You can further limit access by applying additional role authorization attributes at the method level:</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span> <span class="p">=</span> <span class="s">"Developer"</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span> <span class="p">=</span> <span class="s">"Manager"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IUserGrain</span> <span class="p">:</span> <span class="n">IGrainWithStringKey</span>
<span class="p">{</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomething</span><span class="p">();</span>

    <span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span> <span class="p">=</span> <span class="s">"Manager"</span><span class="p">)]</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomethingElse</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div><p>In the previous code snippet members of the <code class="highlighter-rouge">Developer</code> role or the <code class="highlighter-rouge">Manager</code> role can access the grain and the <strong><code class="highlighter-rouge">DoSomething</code></strong> method, but only members of the <code class="highlighter-rouge">Manager</code> role can access the <strong><code class="highlighter-rouge">DoSomethingElse</code></strong> method.</p><p>You can also lock down a grain but allow anonymous, unauthenticated access to individual methods.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Authorize</span><span class="p">]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IUserGrain</span> <span class="p">:</span> <span class="n">IGrainWithStringKey</span>
<span class="p">{</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomething</span><span class="p">();</span>

    <span class="p">[</span><span class="n">AllowAnonymous</span><span class="p">]</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">DoSomethingElse</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div></div></div></div></div>
